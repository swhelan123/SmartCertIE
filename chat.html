<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SmartCert - Chat</title>

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Shared CSS -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Tab Icon -->
    <link rel="icon" type="image/png" href="assets/img/tab_icon.png" />
  </head>
  <body>
    <!-- PILL CONTAINER at top-right -->
    <div id="topRightContainer" class="pill-container">
      <!-- Login button (hidden if user is logged in) -->
      <button id="loginBtn" class="login-button hidden">Login/Signup</button>

      <!-- Profile pic (hidden if user is logged out) -->
      <img
        id="profilePic"
        class="profile-pic hidden"
        src="assets/img/pfp.avif"
        alt="Profile"
      />

      <!-- Theme toggle icon (sun/moon) -->
      <img
        id="modeIcon"
        class="mode-icon"
        src="assets/img/dark.png"
        alt="Toggle Theme"
      />
    </div>

    <!-- HAMBURGER PILL (TOP-LEFT) -->
    <div id="hamburgerContainer" class="pill-container pill-left">
      <div id="hamburgerBtnChat" class="hamburgerChat">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h1 style="margin: 0">
          <a
            href="index.html?showLanding"
            style="color: inherit; text-decoration: none"
          >
            SmartCert
          </a>
        </h1>
        <p>Leaving Cert Biology</p>
      </div>
      <nav class="sidebar-nav">
        <a href="#" data-section="chatSection">ðŸ’¬ Chat</a>
        <a href="#" data-section="notebookSection">ðŸ““ Notebook</a>
      </nav>

      <!-- Account link at bottom -->
      <div class="sidebar-footer">
        <a href="#" id="accountLink">ðŸ‘¤ Account</a>
      </div>
    </aside>

    <!-- BACKDROP OVERLAY for dimming the background -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Chat Section (single container) -->
      <section id="chatSection" class="chat-container">
        <!-- Topic Selector (Group -> Chapter -> Selected Topic) -->
        <div class="topic-selector" id="topicSelector">
          <h3>Choose a topic to give Certi some context</h3>
          <!-- Unit Buttons Container (initially visible) -->
          <div id="unitContainer" class="unit-container">
            <button class="unit-button unit-green" data-unit="A">
              Unit 1: The Study of Life
            </button>
            <button class="unit-button unit-purple" data-unit="B">
              Unit 2: The Cell
            </button>
            <button class="unit-button unit-red" data-unit="C">
              Unit 3: The Organism
            </button>
          </div>

          <!-- Chapter Buttons Container (initially hidden) -->
          <div id="chapterContainer" class="chapter-container hidden"></div>

          <!-- Selected Topic Display (initially hidden) -->
          <div
            id="selectedTopicContainer"
            class="selected-topic-container hidden"
          >
            <span id="selectedTopicLabel" class="selected-topic-label"></span>
            <button id="changeTopicBtn" class="change-topic-button">
              Change Topic
            </button>
          </div>
        </div>

        <!-- Chat Window -->
        <div class="chat-messages" id="chatMessages">
          <!-- Example initial bot message -->
          <div class="chat-message message-bot overlay-row">
            <div class="bubble-container">
              <img
                class="chat-avatar"
                src="assets/img/certi.png"
                alt="Bot Avatar"
              />
              <div class="chat-bubble">
                Hi there, I'm Certi, your personal Leaving Cert biology tutor!
              </div>
            </div>
          </div>
        </div>

        <!-- Chat Input -->
        <div class="chat-input-area">
          <input
            type="text"
            id="chatInput"
            placeholder="Ask a Biology question..."
          />
          <button id="sendBtn">Send</button>
        </div>
      </section>

      <!-- Notebook Section -->
      <section id="notebookSection" class="section-content hidden">
        <h2>Filter Topics</h2>

        <!-- Filter Buttons (A/B/C) in a "pill" style container -->
        <div id="notebookUnitContainer" class="unit-container">
          <button data-unit="all" class="unit-button unit-gray">All</button>
          <button data-unit="A" class="unit-button unit-green">
            Unit 1: The Study of Life
          </button>
          <button data-unit="B" class="unit-button unit-purple">
            Unit 2: The Cell
          </button>
          <button data-unit="C" class="unit-button unit-red">
            Unit 3: The Organism
          </button>
        </div>

        <!-- Grid of cards -->
        <div id="notebookGrid" class="notebook-grid"></div>
      </section>

      <!-- Modal for viewing a single notebook entry in detail -->
      <div id="notebookModal" class="notebook-modal hidden">
        <div class="notebook-modal-content">
          <button id="notebookModalClose" class="notebook-modal-close">
            <!-- Simple SVG close icon (24x24) -->
            <svg
              width="24"
              height="24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>

          <h3 id="notebookModalQuestion"></h3>
          <div id="notebookModalAnswer"></div>
          <div class="notebook-modal-footer">
            <span id="notebookModalDate"></span>
            <button id="notebookModalDelete" class="notebook-delete-button">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Link to our main JS (Firebase logic + chat + chatbot integration) -->
    <script type="module" src="js/script.js"></script>
    <script type="module" src="js/chat.js"></script>

    <!-- Marked (Markdown parser) -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js"></script>
  </body>
</html>
