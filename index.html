<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SmartCert - Home</title>

        <!-- Google Font -->
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />

        <!-- Shared CSS -->
        <link rel="stylesheet" href="styles.css" />

        <!-- Tab Icon -->
        <link rel="icon" type="image/png" href="assets/img/tab_icon.png" />
    </head>
    <body>
        <!--
      PILL CONTAINER at top-right:
      Includes either the Login button OR the Profile Pic,
      plus the Mode Toggle icon
    -->
        <div id="topRightContainer" class="pill-container">
            <!-- The login button is shown if user NOT logged in -->
            <button id="loginBtn" class="login-button hidden">Login</button>

            <!-- The user‚Äôs profile pic (hidden if not logged in) -->
            <img id="profilePic" class="profile-pic hidden" src="assets/img/pfp.avif" alt="Profile" />

            <!-- The theme toggle icon (sun or moon) -->
            <img id="modeIcon" class="mode-icon" src="assets/img/dark.png" alt="Toggle Theme" />
        </div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1>SmartCert</h1>
                <p>Leaving Cert Biology</p>
            </div>
            <nav class="sidebar-nav">
                <a href="#" data-section="chatSection">üí¨ Chat</a>
                <a href="#" data-section="notebookSection">üìì Notebook</a>
                <a href="about.html">üîç About Us</a>
            </nav>

            <!-- Account button at bottom -->
            <div class="sidebar-footer">
                <a href="#" id="accountLink">üë§ Account</a>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Chat Section -->
            <section id="chatSection" class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <!-- Example chat messages -->
                    <div class="chat-message message-bot">Hi there! Ask me anything about Biology.</div>
                    <div class="chat-message message-user">What is photosynthesis?</div>
                    <div class="chat-message message-bot">Photosynthesis is how green plants convert sunlight into chemical energy.</div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chatInput" placeholder="Ask a Biology question..." />
                    <button id="sendBtn">Send</button>
                </div>
            </section>

            <!-- Notebook Section (hidden by default) -->
            <section id="notebookSection" class="section-content hidden">
                <h2>Notebook</h2>
                <p>Saved chatbot responses will appear here.</p>
                <ul id="savedResponses" style="list-style: disc; margin-left: 1.5rem"></ul>
            </section>
        </div>

        <!-- Firebase v9 (Modular) - load directly from CDN -->
        <script type="module">
            // 1) Import only what you need from Firebase v9
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-analytics.js";
            import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js";
            import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore.js";

            // 2) Your Firebase configuration (from the Firebase console)
            const firebaseConfig = {
                apiKey: "AIzaSyDe5pXEGR015hQbXvoSGyJc955hgXO8tio",
                authDomain: "smartcert-f1965.firebaseapp.com",
                projectId: "smartcert-f1965",
                storageBucket: "smartcert-f1965.appspot.com",
                messagingSenderId: "1075815326636",
                appId: "1:1075815326636:web:ffd63ed204d2832e295009",
                measurementId: "G-6CJR44Z4MK",
            };

            // 3) Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);

            // 4) Initialize Auth & Firestore
            const auth = getAuth(app);
            const db = getFirestore(app);

            // 5) Example: watch auth state changes
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    console.log("User logged in:", user.uid);
                    // e.g., show profile pic, hide login button
                    document.getElementById("loginBtn").classList.add("hidden");
                    document.getElementById("profilePic").classList.remove("hidden");
                } else {
                    console.log("User logged out or not logged in.");
                    // e.g., hide profile pic, show login button
                    document.getElementById("loginBtn").classList.remove("hidden");
                    document.getElementById("profilePic").classList.add("hidden");
                }
            });

            // 6) For demonstration: hooking up your "Login" button
            //    (In real usage, you'd do this on a separate login page, etc.)
            const loginBtn = document.getElementById("loginBtn");
            if (loginBtn) {
                loginBtn.addEventListener("click", async () => {
                    try {
                        // Hard-coded example (replace with real form input)
                        const email = "test@example.com";
                        const password = "123456";
                        await signInWithEmailAndPassword(auth, email, password);
                        alert("Logged in (demo)!");
                    } catch (err) {
                        alert("Login error: " + err.message);
                    }
                });
            }
        </script>

        <!-- Your custom logic (chat, notebook, etc.) can go in script.js or inline -->
        <script src="script.js" type="module"></script>
    </body>
</html>
